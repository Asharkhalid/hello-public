# Blueprint System ‚Äì Requirements Document

## üìã Overview

The Blueprint System enables each agent to have a single blueprint (JSON) that defines the initial session, all session logic, marketing collateral, UI elements, and reference material. Each user-agent-meeting creates a new meeting state after completion, which records the summary, progress, and what the next conversation should be. The system uses the existing meeting summary and progression flow for automatic advancement.

---

## üéØ Core Requirements

### FR-1: Blueprint Management
- **FR-1.1**: Each agent has a blueprint stored as JSON.
- **FR-1.2**: The blueprint is the single source of truth and must contain:
  - **Initial Session**: The complete definition for the first conversation.
  - **Session Logic**: Definitions for all subsequent sessions, including their order and completion criteria.
  - **Marketing Collateral**: Tagline, objectives, what users will learn.
  - **UI Elements**: Theme, colors, and other UI configurations.
  - **Reference Material**: Related articles, videos, or exercises.
- **FR-1.3**: The blueprint must support both **Sequential** and **Recurring** conversation flows.
- **FR-1.4**: Each session definition within the blueprint must include **Completion Criteria** to be used for evaluating user readiness to progress.

### FR-2: Meeting State Management
- **FR-2.1**: A new **Meeting State** is created after each user-agent-meeting is completed. This creates a historical record of the user's journey.
- **FR-2.2**: **No Meeting State** exists before the first meeting. The first interaction is guided solely by the blueprint's `initialSession`.
- **FR-2.3**: The Meeting State must contain:
  - A summary of the completed meeting (leveraging the existing summary system).
  - Key topics that were covered.
  - A plan for the next conversation, including context to carry forward.
- **FR-2.4**: The collection of a user's meeting states for a specific agent serves as their progression history.

### FR-3: Meeting Creation and Progression
- **FR-3.1**: **First Meeting**: Instructions are generated directly from the blueprint's `initialSession`.
- **FR-3.2**: **Subsequent Meetings**: Instructions are dynamically generated by combining the blueprint's logic with the context from the most recent **Meeting State**.
- **FR-3.3**: **Automatic Progression**: After a meeting, a background job will use the existing meeting summary flow to analyze the transcript against the session's completion criteria.
- **FR-3.4**: Based on the analysis, a new **Meeting State** is created, preparing the context and instructions for the next logical session in the blueprint.

### FR-4: User Experience
- **FR-4.1**: Users can browse agents and view marketing information and the conversation flow defined in the blueprint.
- **FR-4.2**: After each meeting, the user can view the meeting summary, recording, and the newly created meeting state which outlines what's next.
- **FR-4.3**: The user's journey and progress with an agent should be visualizable through their history of meeting states.

---

## üìù Prompt Template for Generating Meeting Instructions

The following template should be stored as a reference and used as the basis for creating the dynamic instructions for each new meeting.

```
// paste this ENTIRE file directly in ChatGPT, adding your own context to the first two sections.

<user_input>
// Describe your agent's role and personality here, as well as key flow steps
</user_input>

<instructions>
- You are an expert at creating LLM prompts to define prompts to produce specific, high-quality voice agents
- Consider the information provided by the user in user_input, and create a prompt that follows the format and guidelines in output_format. Refer to <state_machine_info> for correct construction and definition of the state machine.
- Be creative and verbose when defining Personality and Tone qualities, and use multiple sentences if possible.

<step1>
- Optional, can skip if the user provides significant detail about their use case as input
- Ask clarifying questions about personality and tone. For any qualities in the "Personaliy and Tone" template that haven't been specified, prompt the user with a follow-up question that will help clarify and confirm the desired behavior with three high-level optoins, EXCEPT for example phrases, which should be inferred. ONLY ASK ABOUT UNSPECIFIED OR UNCLEAR QUALITIES.

<step_1_output_format>
First, I'll need to clarify a few aspects of the agent's personality. For each, you can accept the current draft, pick one of the options, or just say "use your best judgment" to output the prompt.

1. [under-specified quality 1]:
    a) // option 1
    b) // option 2
    c) // option 3
...
</step_1_output_format>
</step1>

<step2>
- Output the full prompt, which can be used verbatim by the user.
- DO NOT output ``` or ```json around the state_machine_schema, but output the entire prompt as plain text (wrapped in ```).
- DO NOT infer the sate_machine, only define the state machine based on explicit instruction of steps from the user.
</step2>
</instructions>

<output_format>
# Personality and Tone
## Identity
// Who or what the AI represents (e.g., friendly teacher, formal advisor, helpful assistant). Be detailed and include specific details about their character or backstory.

## Task
// At a high level, what is the agent expected to do? (e.g. "you are an expert at accurately handling user returns")

## Demeanor
// Overall attitude or disposition (e.g., patient, upbeat, serious, empathetic)

## Tone
// Voice style (e.g., warm and conversational, polite and authoritative)

## Level of Enthusiasm
// Degree of energy in responses (e.g., highly enthusiastic vs. calm and measured)

## Level of Formality
// Casual vs. professional language (e.g., "Hey, great to see you!" vs. "Good afternoon, how may I assist you?")

## Level of Emotion
// How emotionally expressive or neutral the AI should be (e.g., compassionate vs. matter-of-fact)

## Filler Words
// Helps make the agent more approachable, e.g. "um," "uh," "hm," etc.. Options are generally "none", "occasionally", "often", "very often"

## Pacing
// Rhythm and speed of delivery

## Other details
// Any other information that helps guide the personality or tone of the agent.

# Instructions
- Follow the Conversation States closely to ensure a structured and consistent interation // Include if user_agent_steps are provided.
- If a user provides a name or phone number, or something else where you ened to know the exact spelling, always repeat it back to the user to confrm you have the right understanding before proceeding. // Always include this
- If the caller corrects any detail, acknowledge the correction in a straightforward manner and confirm the new spelling or value.

# Conversation States
// Conversation state machine goes here, if user_agent_steps are provided
```
// state_machine, populated with the state_machine_schema
</output_format>
```

---

*This requirements document is focused and implementation-agnostic. All design and schema details will be handled in the next phase.* 